{extend name="public/form" /}

{block name="body"}
	<form class="layui-form" action="">
		<div class="mainBox">
			<div class="main-container">
				<input type="text" name="id" lay-verify="required" class="layui-input layui-hide" value="{$section.id}">
				<div class="layui-form-item">
					<label class="layui-form-label">标题</label>
					<div class="layui-input-block">
						<input type="text" name="title" lay-verify="required" placeholder="标题" autocomplete="off" class="layui-input" value="{$section.title}">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">子标题</label>
					<div class="layui-input-block">
						<input type="text" name="subtitle" lay-verify="required" placeholder="子标题描述" autocomplete="off" class="layui-input" value="{$section.subtitle}">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">别名</label>
					<div class="layui-input-block">
						<input type="text" name="alias" lay-verify="required" placeholder="英文名*" autocomplete="off" class="layui-input" value="{$section.alias}">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">开关</label>
					<div class="layui-input-block">
						<input type="checkbox" name="status" lay-skin="switch" lay-text="启用|禁用" lay-filter="section-check" {if $section.status == 1} checked {/if} />
					</div>
				</div>
			</div>
		</div>
		<div class="bottom">
			<div class="button-container">
				<button type="submit" class="pear-btn pear-btn-primary pear-btn-sm" lay-submit="" lay-filter="section-save">
					<i class="layui-icon layui-icon-ok"></i>
					提交
				</button>
				<button type="reset" class="pear-btn pear-btn-sm">
					<i class="layui-icon layui-icon-refresh"></i>
					重置
				</button>
			</div>
		</div>
	</form>

	{__block__}

	<script>
		layui.use(function(){
			var $ = layui.jquery
			,form = layui.form ;

			let ADD_EDIT = "{:url('service.section/edit')}";
			
			form.on('submit(section-save)', function(data) {

				data.field.status = data.field.status == 'on' ? 1 : 0;

				$.ajax({
					url: ADD_EDIT,
					data: JSON.stringify(data.field),
					dataType: 'json',
					contentType: 'application/json',
					type: 'post',
					success: function(result) {
						if (result.code === 0) {
							layer.msg(result.msg, {
								icon: 1,
								time: 1000
							}, function() {
								// parent.layui.table.reload("section-table");
								parent.layer.close(parent.layer.getFrameIndex(window.name)); //关闭当前页
								window.parent.location.reload();
							});
						} else {
							layer.msg(result.msg, {
								icon: 2,
								time: 1000
							});
						}
					}
				})
				return false;
			});

		})
	</script>
{/block}