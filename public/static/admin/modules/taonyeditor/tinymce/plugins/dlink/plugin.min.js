/*
 * @Author: TaoLer <317927823@qq.com>
 * @Date: 2022-07-28 20:35:44
 * @LastEditTime: 2022-07-31 08:47:58
 * @LastEditors: TaoLer
 * @Description: 优化版
 * @FilePath: \github\TaoLer\public\addons\taonyeditor\tinymce\plugins\dlink\plugin.min.js
 * Copyright (c) 2020~2022 https://www.aieok.com All rights reserved.
 */
tinymce.PluginManager.add('dlink', function(editor, url) {
    // var openDialog = function () {
    //   return editor.windowManager.open({
    //     title: '这里是弹窗标题',
    //     body: {
    //       type: 'panel',
    //       items: [
    //         {
    //           type: 'input',
    //           name: 'title',
    //           label: 'Title'
    //         }
    //       ]
    //     },
    //     buttons: [
    //       {
    //         type: 'cancel',
    //         text: 'Close'
    //       },
    //       {
    //         type: 'submit',
    //         text: 'Save',
    //         primary: true
    //       }
    //     ],
    //     onSubmit: function (api) {
    //       var data = api.getData();
    //       // 将输入框内容插入到内容区光标位置
    //       editor.insertContent('插入的文字是: ' + data.title);
    //       api.close();
    //     }
    //   });
    // };


    var dLink = function() {
        var str = tinymce.activeEditor.getContent().replace(/(<\/?a.*?>)|(<\/?span.*?>)/g, '').replace(/id="(.*?)"/gi,'');
        tinymce.activeEditor.setContent(str);
    };

    
    // 注册一个工具栏按钮名称
    editor.ui.registry.addButton('dlink', {
        icon: 'unlink',
        tooltip: '取消全部a链接',
        onAction: function () {
        //openDialog();
        dLink();
        }
    });
  
    // 注册一个菜单项名称 menu/menubar
    editor.ui.registry.addMenuItem('dlink', {
        icon: 'unlink',
        text: '取消全部a链接',
        onAction: function() {
        //openDialog();
        dLink();
        }
    });
  
    return {
      getMetadata: function () {
        return  {
          //插件名和链接会显示在“帮助”→“插件”→“已安装的插件”中
          name: "dlink",//插件名称
          url: "https://www.aieok.com", //作者网址
        };
      }
    };
  });